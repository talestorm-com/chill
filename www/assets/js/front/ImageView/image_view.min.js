(function(){window.Eve=window.Eve||{};window.Eve.EFO=window.Eve.EFO||{};window.Eve.EFO.Ready=window.Eve.EFO.Ready||[];window.Eve.EFO.Ready.push(ready)
function ready(){var E=window.Eve,EFO=E.EFO,U=EFO.U,APS=Array.prototype.slice,H=null,TEMPLATES={};TEMPLATES={image_view:"<div class=\"ImageViewOuterWrapper\">\n    <div class=\"ImageViewInner\">\n        <div class=\"ImageViewClose\" data-command=\"close\"><div class=\"ImageViewCloseButton\">\u0417\u0430\u043a\u0440\u044b\u0442\u044c<\/div><\/div>\n        <div class=\"ImageViewImage\" data-command=\"close\"><img data-role=\"image\" src=\"void(0)\"\/><\/div>\n        <div class=\"ImageViewPreloader\" data-role=\"loader\">\n            <div class=\"ImageViewPreloaderInner\">\n                <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><svg xmlns:svg=\"http:\/\/www.w3.org\/2000\/svg\" xmlns=\"http:\/\/www.w3.org\/2000\/svg\" xmlns:xlink=\"http:\/\/www.w3.org\/1999\/xlink\" version=\"1.0\" width=\"100px\" height=\"100px\" viewBox=\"0 0 128 128\" xml:space=\"preserve\"><g><path d=\"M59.6 0h8v40h-8V0z\" fill=\"#000000\" fill-opacity=\"1\"\/><path d=\"M59.6 0h8v40h-8V0z\" fill=\"#cccccc\" fill-opacity=\"0.2\" transform=\"rotate(30 64 64)\"\/><path d=\"M59.6 0h8v40h-8V0z\" fill=\"#cccccc\" fill-opacity=\"0.2\" transform=\"rotate(60 64 64)\"\/><path d=\"M59.6 0h8v40h-8V0z\" fill=\"#cccccc\" fill-opacity=\"0.2\" transform=\"rotate(90 64 64)\"\/><path d=\"M59.6 0h8v40h-8V0z\" fill=\"#cccccc\" fill-opacity=\"0.2\" transform=\"rotate(120 64 64)\"\/><path d=\"M59.6 0h8v40h-8V0z\" fill=\"#b2b2b2\" fill-opacity=\"0.3\" transform=\"rotate(150 64 64)\"\/><path d=\"M59.6 0h8v40h-8V0z\" fill=\"#999999\" fill-opacity=\"0.4\" transform=\"rotate(180 64 64)\"\/><path d=\"M59.6 0h8v40h-8V0z\" fill=\"#7f7f7f\" fill-opacity=\"0.5\" transform=\"rotate(210 64 64)\"\/><path d=\"M59.6 0h8v40h-8V0z\" fill=\"#666666\" fill-opacity=\"0.6\" transform=\"rotate(240 64 64)\"\/><path d=\"M59.6 0h8v40h-8V0z\" fill=\"#4c4c4c\" fill-opacity=\"0.7\" transform=\"rotate(270 64 64)\"\/><path d=\"M59.6 0h8v40h-8V0z\" fill=\"#333333\" fill-opacity=\"0.8\" transform=\"rotate(300 64 64)\"\/><path d=\"M59.6 0h8v40h-8V0z\" fill=\"#191919\" fill-opacity=\"0.9\" transform=\"rotate(330 64 64)\"\/><animateTransform attributeName=\"transform\" type=\"rotate\" values=\"0 64 64;30 64 64;60 64 64;90 64 64;120 64 64;150 64 64;180 64 64;210 64 64;240 64 64;270 64 64;300 64 64;330 64 64\" calcMode=\"discrete\" dur=\"960ms\" repeatCount=\"indefinite\"><\/animateTransform><\/g><\/svg>\n            <\/div>\n        <\/div>\n        <div class=\"ImageViewNavigation\">\n            <div class=\"ImageViewNavigationInner\" data-role=\"nav_block\"><\/div>\n        <\/div>\n    <\/div>    \n<\/div>",nav_view:"{{#do_display_nav}}\n{{#images}}\n<a href=\"#\" data-image=\"{{image}}\" data-command=\"select_image\" class=\"{{#is_current_image}}ImageViewImageSelectedPin{{\/is_current_image}}\"><\/a>\n{{\/images}}\n{{\/do_display_nav}}"};var STYLES={};STYLES={style:"body.imageview_fullview_visible{box-sizing:border-box;height:100%;overflow:hidden}.ImageViewOuterWrapper{box-sizing:border-box;position:fixed;top:0;left:0;width:100%;height:100%;overflow:hidden;z-index:3}.ImageViewInner{box-sizing:border-box;height:100%;width:100%;overflow:auto}.ImageViewImage{box-sizing:border-box;width:100%}.ImageViewImage img{width:100%}.ImageViewPreloader{box-sizing:border-box;background:transparent;width:100%;height:100%;position:absolute;top:0;left:0;pointer-events:none;background:rgba(255,255,255,0)}.ImageViewPreloader{display:flex;flex-direction:row;justify-content:center;align-items:center}.ImageViewPreloaderInner{width:5em;height:5em}.ImageViewPreloaderInner svg{width:100%;height:100%}.ImageViewPreloader{display:flex;flex-direction:row;justify-content:center;align-items:center;display:none}.ImageViewPreloaderInner{box-sizing:border-box;width:4em;height:4em}.ImageViewPreloaderInner svg{width:100%;height:100%}.ImageViewClose{position:absolute;top:1em;right:1em;cursor:pointer}.ImageViewCloseButton{background:white;padding:.25em 1em;border-radius:5%;box-shadow:0 .1em .4em 0 black}.ImageViewImage{background:white}.ImageViewNavigation{box-sizing:border-box;position:absolute;bottom:0;left:0;display:block;width:100%}.ImageViewNavigationInner{box-sizing:border-box;width:100%;padding:.25em .5em;display:flex;flex-direction:row;justify-content:center;align-items:center}.ImageViewNavigationInner a{line-height:0;width:.75em;height:.75em;margin:0 .75em;background:white;border-radius:50%;margin-bottom:1em;border:1px solid black}a.ImageViewImageSelectedPin{background:#f15a24}.ImageViewOuterWrapper{background:white}"};var style=jQuery('<style type="text/css" data-id="ImageView"></style>');jQuery('head').append(style);style.html(U.NEString(STYLES.style,''))
function image_view(){return image_view.is(H)?H:((image_view.is(this)?this.init:image_view.F).apply(this,APS.call(arguments)))};var IVP=U.FixCon(image_view).prototype;IVP.images=null;IVP.handle=null;IVP.image_container=null;IVP.loader=null;IVP.nav_block=null;IVP.current_image_index=null;IVP.init=function(){this.handle=jQuery(Mustache.render(TEMPLATES.image_view,this));this.image_container=this.handle.find("[data-role=\"image\"]");this.loader=this.handle.find("[data-role=\"loader\"]");this.nav_block=this.handle.find("[data-role=\"nav_block\"]");this.handle.on('click',"[data-command]",this.on_command.bindToObjectWParam(this));this.do_display_nav=this._do_display_nav.bindToObject(this);this.is_current_image=this._is_current_image.bindToObjectWParam(this);try{this.image_container.get(0).addEventListener('load',this.hide_loader.bindToObject(this),true)}catch(e){};return this};IVP._do_display_nav=function(){return(U.isArray(this.images)&&this.images.length>1)?true:false};IVP._is_current_image=function(ci){var cu_id=this.images[this.current_image_index].image;return ci.image===cu_id};IVP.on_command=function(n,e){var jn=jQuery(n),cmd=U.NEString(jn.data('command'),null);if(cmd){var fn=["on_command_",cmd.toLowerCase()].join('');if(U.isCallable(this[fn]))this[fn](jn,e)};return this};IVP.on_command_select_image=function(jn,e){e.stopPropagation();e.preventDefault?e.preventDefault():e.returnValue=false;this.setup(this.images,U.NEString(jn.data('image'),null)).show();return this};IVP.on_command_close=function(){this.hide();return this};IVP.setup=function(images,selected_image){images=U.safeArray(images);this.images=[];for(var i=0;i<images.length;i++){var image=new IVImage(images[i]);if(image&&image.is_valid())this.images.push(image)};this.current_image_index=0;for(var i=0;i<this.images.length;i++)if(this.images[i].image===selected_image){this.current_image_index=i;break};this.nav_block.html(Mustache.render(TEMPLATES.nav_view,this,TEMPLATES));return this};IVP.get_image_spec=function(){var ww=document.documentElement.clientWidth,ww5=Math.ceil(ww/500),rw=ww5*500;return["SW_",rw,"CF_1"].join('')};IVP.get_current_image_url=function(){var image=this.images[this.current_image_index];return["/media/",image.context,"/",image.owner_id,"/",image.image,".",this.get_image_spec(),".jpg"].join('')};IVP.show=function(){if(U.isArray(this.images)){this.handle.appendTo('body');this.handle.show();jQuery('body').addClass('imageview_fullview_visible');this.show_loader();this.image_container.attr("src",this.get_current_image_url());this.image_container.show()};return this};IVP.hide=function(){this.handle.hide();this.image_container.hide();jQuery('body').removeClass('imageview_fullview_visible');this.images=null;return this};IVP.show_loader=function(){this.loader.css("display","flex");return this};IVP.hide_loader=function(){this.loader.css("display","none");return this}
function IVImage(){return(IVImage.is(this)?this.init:IVImage.F).apply(this,APS.call(arguments))};var IP=U.FixCon(IVImage).prototype;IP.context=null;IP.owner_id=null;IP.image=null;IP.title=null;IP.init=function(x){x=U.safeObject(x);this.context=U.NEString(x.context,null);this.owner_id=U.NEString(x.owner_id,null);this.image=U.NEString(x.image,null);this.title=U.NEString(x.title,null);return this};IP.is_valid=function(){return(this.context&&this.owner_id&&this.image)?true:false};E.image_view=image_view;E.image_view_ready=E.image_view_ready||[];var b=U.safeArray(E.image_view_ready);E.image_view_ready={push:function(){var args=APS.call(arguments);for(var i=0;i<args.length;i++)if(U.isCallable(args[i]))try{args[i]()}catch(e){U.TError(e)}}};for(var i=0;i<b.length;i++)E.image_view_ready.push(b[i])}})()